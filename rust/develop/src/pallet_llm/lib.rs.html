<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Source of the Rust file `frame/llm/src/lib.rs`."><meta name="keywords" content="rust, rustlang, rust-lang"><title>lib.rs - source</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-71d02aebf3a9cedb.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-c11f492748536797.css"><link rel="stylesheet" disabled href="../../static.files/dark-a78f946771c40031.css"><link rel="stylesheet" disabled href="../../static.files/ayu-70b683d68cb31790.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../static.files/source-script-74087aa2e88f4475.js"></script><script defer src="../../source-files.js"></script><script defer src="../../static.files/main-0dede64717b247ca.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-201a7e04dc4c6fce.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc source"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"></nav><main><div class="width-limiter"><nav class="sub"><a class="sub-logo-container" href="../../pallet_llm/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="example-wrap"><pre class="src-line-numbers"><span id="1">1</span>
<span id="2">2</span>
<span id="3">3</span>
<span id="4">4</span>
<span id="5">5</span>
<span id="6">6</span>
<span id="7">7</span>
<span id="8">8</span>
<span id="9">9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
<span id="62">62</span>
<span id="63">63</span>
<span id="64">64</span>
<span id="65">65</span>
<span id="66">66</span>
<span id="67">67</span>
<span id="68">68</span>
<span id="69">69</span>
<span id="70">70</span>
<span id="71">71</span>
<span id="72">72</span>
<span id="73">73</span>
<span id="74">74</span>
<span id="75">75</span>
<span id="76">76</span>
<span id="77">77</span>
<span id="78">78</span>
<span id="79">79</span>
<span id="80">80</span>
<span id="81">81</span>
<span id="82">82</span>
<span id="83">83</span>
<span id="84">84</span>
<span id="85">85</span>
<span id="86">86</span>
<span id="87">87</span>
<span id="88">88</span>
<span id="89">89</span>
<span id="90">90</span>
<span id="91">91</span>
<span id="92">92</span>
<span id="93">93</span>
<span id="94">94</span>
<span id="95">95</span>
<span id="96">96</span>
<span id="97">97</span>
<span id="98">98</span>
<span id="99">99</span>
<span id="100">100</span>
<span id="101">101</span>
<span id="102">102</span>
<span id="103">103</span>
<span id="104">104</span>
<span id="105">105</span>
<span id="106">106</span>
<span id="107">107</span>
<span id="108">108</span>
<span id="109">109</span>
<span id="110">110</span>
<span id="111">111</span>
<span id="112">112</span>
<span id="113">113</span>
<span id="114">114</span>
<span id="115">115</span>
<span id="116">116</span>
<span id="117">117</span>
<span id="118">118</span>
<span id="119">119</span>
<span id="120">120</span>
<span id="121">121</span>
<span id="122">122</span>
<span id="123">123</span>
<span id="124">124</span>
<span id="125">125</span>
<span id="126">126</span>
<span id="127">127</span>
<span id="128">128</span>
<span id="129">129</span>
<span id="130">130</span>
<span id="131">131</span>
<span id="132">132</span>
<span id="133">133</span>
<span id="134">134</span>
<span id="135">135</span>
<span id="136">136</span>
<span id="137">137</span>
<span id="138">138</span>
<span id="139">139</span>
<span id="140">140</span>
<span id="141">141</span>
<span id="142">142</span>
<span id="143">143</span>
<span id="144">144</span>
<span id="145">145</span>
<span id="146">146</span>
<span id="147">147</span>
<span id="148">148</span>
<span id="149">149</span>
<span id="150">150</span>
<span id="151">151</span>
<span id="152">152</span>
<span id="153">153</span>
<span id="154">154</span>
<span id="155">155</span>
<span id="156">156</span>
<span id="157">157</span>
<span id="158">158</span>
<span id="159">159</span>
<span id="160">160</span>
<span id="161">161</span>
<span id="162">162</span>
<span id="163">163</span>
<span id="164">164</span>
<span id="165">165</span>
<span id="166">166</span>
<span id="167">167</span>
<span id="168">168</span>
<span id="169">169</span>
<span id="170">170</span>
<span id="171">171</span>
<span id="172">172</span>
<span id="173">173</span>
<span id="174">174</span>
<span id="175">175</span>
<span id="176">176</span>
<span id="177">177</span>
<span id="178">178</span>
<span id="179">179</span>
<span id="180">180</span>
<span id="181">181</span>
<span id="182">182</span>
<span id="183">183</span>
<span id="184">184</span>
<span id="185">185</span>
<span id="186">186</span>
<span id="187">187</span>
<span id="188">188</span>
<span id="189">189</span>
<span id="190">190</span>
<span id="191">191</span>
<span id="192">192</span>
<span id="193">193</span>
<span id="194">194</span>
<span id="195">195</span>
<span id="196">196</span>
<span id="197">197</span>
<span id="198">198</span>
<span id="199">199</span>
<span id="200">200</span>
<span id="201">201</span>
<span id="202">202</span>
<span id="203">203</span>
<span id="204">204</span>
<span id="205">205</span>
<span id="206">206</span>
<span id="207">207</span>
<span id="208">208</span>
<span id="209">209</span>
<span id="210">210</span>
<span id="211">211</span>
<span id="212">212</span>
<span id="213">213</span>
<span id="214">214</span>
<span id="215">215</span>
<span id="216">216</span>
<span id="217">217</span>
<span id="218">218</span>
<span id="219">219</span>
<span id="220">220</span>
<span id="221">221</span>
<span id="222">222</span>
<span id="223">223</span>
<span id="224">224</span>
<span id="225">225</span>
<span id="226">226</span>
<span id="227">227</span>
<span id="228">228</span>
<span id="229">229</span>
<span id="230">230</span>
<span id="231">231</span>
<span id="232">232</span>
<span id="233">233</span>
<span id="234">234</span>
<span id="235">235</span>
<span id="236">236</span>
<span id="237">237</span>
<span id="238">238</span>
<span id="239">239</span>
<span id="240">240</span>
<span id="241">241</span>
<span id="242">242</span>
<span id="243">243</span>
<span id="244">244</span>
<span id="245">245</span>
<span id="246">246</span>
<span id="247">247</span>
<span id="248">248</span>
<span id="249">249</span>
<span id="250">250</span>
<span id="251">251</span>
<span id="252">252</span>
<span id="253">253</span>
<span id="254">254</span>
<span id="255">255</span>
<span id="256">256</span>
<span id="257">257</span>
<span id="258">258</span>
<span id="259">259</span>
<span id="260">260</span>
<span id="261">261</span>
<span id="262">262</span>
<span id="263">263</span>
<span id="264">264</span>
<span id="265">265</span>
<span id="266">266</span>
<span id="267">267</span>
<span id="268">268</span>
<span id="269">269</span>
<span id="270">270</span>
<span id="271">271</span>
<span id="272">272</span>
<span id="273">273</span>
<span id="274">274</span>
<span id="275">275</span>
<span id="276">276</span>
<span id="277">277</span>
<span id="278">278</span>
<span id="279">279</span>
<span id="280">280</span>
<span id="281">281</span>
<span id="282">282</span>
<span id="283">283</span>
<span id="284">284</span>
<span id="285">285</span>
<span id="286">286</span>
<span id="287">287</span>
<span id="288">288</span>
<span id="289">289</span>
<span id="290">290</span>
<span id="291">291</span>
<span id="292">292</span>
<span id="293">293</span>
<span id="294">294</span>
<span id="295">295</span>
<span id="296">296</span>
<span id="297">297</span>
<span id="298">298</span>
<span id="299">299</span>
<span id="300">300</span>
<span id="301">301</span>
<span id="302">302</span>
<span id="303">303</span>
<span id="304">304</span>
<span id="305">305</span>
<span id="306">306</span>
<span id="307">307</span>
<span id="308">308</span>
<span id="309">309</span>
<span id="310">310</span>
<span id="311">311</span>
<span id="312">312</span>
<span id="313">313</span>
<span id="314">314</span>
<span id="315">315</span>
<span id="316">316</span>
<span id="317">317</span>
<span id="318">318</span>
<span id="319">319</span>
<span id="320">320</span>
<span id="321">321</span>
<span id="322">322</span>
<span id="323">323</span>
<span id="324">324</span>
<span id="325">325</span>
<span id="326">326</span>
<span id="327">327</span>
<span id="328">328</span>
<span id="329">329</span>
<span id="330">330</span>
<span id="331">331</span>
<span id="332">332</span>
<span id="333">333</span>
<span id="334">334</span>
<span id="335">335</span>
<span id="336">336</span>
<span id="337">337</span>
<span id="338">338</span>
<span id="339">339</span>
<span id="340">340</span>
<span id="341">341</span>
<span id="342">342</span>
<span id="343">343</span>
<span id="344">344</span>
<span id="345">345</span>
<span id="346">346</span>
<span id="347">347</span>
<span id="348">348</span>
<span id="349">349</span>
<span id="350">350</span>
<span id="351">351</span>
<span id="352">352</span>
<span id="353">353</span>
<span id="354">354</span>
<span id="355">355</span>
<span id="356">356</span>
<span id="357">357</span>
<span id="358">358</span>
<span id="359">359</span>
<span id="360">360</span>
<span id="361">361</span>
<span id="362">362</span>
<span id="363">363</span>
<span id="364">364</span>
<span id="365">365</span>
<span id="366">366</span>
<span id="367">367</span>
<span id="368">368</span>
<span id="369">369</span>
<span id="370">370</span>
<span id="371">371</span>
<span id="372">372</span>
<span id="373">373</span>
<span id="374">374</span>
<span id="375">375</span>
<span id="376">376</span>
<span id="377">377</span>
<span id="378">378</span>
<span id="379">379</span>
<span id="380">380</span>
<span id="381">381</span>
<span id="382">382</span>
<span id="383">383</span>
<span id="384">384</span>
<span id="385">385</span>
<span id="386">386</span>
<span id="387">387</span>
<span id="388">388</span>
<span id="389">389</span>
<span id="390">390</span>
<span id="391">391</span>
<span id="392">392</span>
<span id="393">393</span>
<span id="394">394</span>
<span id="395">395</span>
<span id="396">396</span>
<span id="397">397</span>
<span id="398">398</span>
<span id="399">399</span>
<span id="400">400</span>
<span id="401">401</span>
<span id="402">402</span>
<span id="403">403</span>
<span id="404">404</span>
<span id="405">405</span>
<span id="406">406</span>
<span id="407">407</span>
<span id="408">408</span>
<span id="409">409</span>
<span id="410">410</span>
<span id="411">411</span>
<span id="412">412</span>
<span id="413">413</span>
<span id="414">414</span>
<span id="415">415</span>
<span id="416">416</span>
<span id="417">417</span>
<span id="418">418</span>
<span id="419">419</span>
<span id="420">420</span>
<span id="421">421</span>
<span id="422">422</span>
<span id="423">423</span>
<span id="424">424</span>
<span id="425">425</span>
<span id="426">426</span>
<span id="427">427</span>
<span id="428">428</span>
<span id="429">429</span>
<span id="430">430</span>
<span id="431">431</span>
<span id="432">432</span>
<span id="433">433</span>
<span id="434">434</span>
<span id="435">435</span>
<span id="436">436</span>
<span id="437">437</span>
<span id="438">438</span>
<span id="439">439</span>
<span id="440">440</span>
<span id="441">441</span>
<span id="442">442</span>
<span id="443">443</span>
<span id="444">444</span>
<span id="445">445</span>
<span id="446">446</span>
<span id="447">447</span>
<span id="448">448</span>
<span id="449">449</span>
<span id="450">450</span>
<span id="451">451</span>
<span id="452">452</span>
<span id="453">453</span>
<span id="454">454</span>
<span id="455">455</span>
<span id="456">456</span>
<span id="457">457</span>
<span id="458">458</span>
<span id="459">459</span>
<span id="460">460</span>
<span id="461">461</span>
<span id="462">462</span>
<span id="463">463</span>
<span id="464">464</span>
<span id="465">465</span>
<span id="466">466</span>
<span id="467">467</span>
<span id="468">468</span>
<span id="469">469</span>
<span id="470">470</span>
<span id="471">471</span>
<span id="472">472</span>
<span id="473">473</span>
<span id="474">474</span>
<span id="475">475</span>
<span id="476">476</span>
<span id="477">477</span>
<span id="478">478</span>
<span id="479">479</span>
<span id="480">480</span>
<span id="481">481</span>
<span id="482">482</span>
<span id="483">483</span>
<span id="484">484</span>
<span id="485">485</span>
<span id="486">486</span>
<span id="487">487</span>
<span id="488">488</span>
<span id="489">489</span>
<span id="490">490</span>
<span id="491">491</span>
<span id="492">492</span>
<span id="493">493</span>
<span id="494">494</span>
<span id="495">495</span>
<span id="496">496</span>
<span id="497">497</span>
<span id="498">498</span>
<span id="499">499</span>
<span id="500">500</span>
<span id="501">501</span>
<span id="502">502</span>
<span id="503">503</span>
<span id="504">504</span>
<span id="505">505</span>
<span id="506">506</span>
<span id="507">507</span>
<span id="508">508</span>
<span id="509">509</span>
<span id="510">510</span>
<span id="511">511</span>
<span id="512">512</span>
<span id="513">513</span>
<span id="514">514</span>
<span id="515">515</span>
<span id="516">516</span>
<span id="517">517</span>
<span id="518">518</span>
<span id="519">519</span>
<span id="520">520</span>
<span id="521">521</span>
<span id="522">522</span>
<span id="523">523</span>
<span id="524">524</span>
<span id="525">525</span>
<span id="526">526</span>
<span id="527">527</span>
<span id="528">528</span>
<span id="529">529</span>
<span id="530">530</span>
<span id="531">531</span>
<span id="532">532</span>
<span id="533">533</span>
<span id="534">534</span>
<span id="535">535</span>
<span id="536">536</span>
<span id="537">537</span>
<span id="538">538</span>
<span id="539">539</span>
<span id="540">540</span>
<span id="541">541</span>
<span id="542">542</span>
<span id="543">543</span>
<span id="544">544</span>
<span id="545">545</span>
<span id="546">546</span>
<span id="547">547</span>
<span id="548">548</span>
<span id="549">549</span>
<span id="550">550</span>
<span id="551">551</span>
<span id="552">552</span>
<span id="553">553</span>
<span id="554">554</span>
<span id="555">555</span>
<span id="556">556</span>
<span id="557">557</span>
<span id="558">558</span>
<span id="559">559</span>
<span id="560">560</span>
<span id="561">561</span>
<span id="562">562</span>
<span id="563">563</span>
<span id="564">564</span>
<span id="565">565</span>
<span id="566">566</span>
<span id="567">567</span>
<span id="568">568</span>
<span id="569">569</span>
<span id="570">570</span>
<span id="571">571</span>
<span id="572">572</span>
<span id="573">573</span>
<span id="574">574</span>
<span id="575">575</span>
<span id="576">576</span>
<span id="577">577</span>
<span id="578">578</span>
<span id="579">579</span>
<span id="580">580</span>
<span id="581">581</span>
<span id="582">582</span>
<span id="583">583</span>
<span id="584">584</span>
<span id="585">585</span>
<span id="586">586</span>
<span id="587">587</span>
<span id="588">588</span>
<span id="589">589</span>
<span id="590">590</span>
<span id="591">591</span>
<span id="592">592</span>
<span id="593">593</span>
<span id="594">594</span>
<span id="595">595</span>
<span id="596">596</span>
<span id="597">597</span>
<span id="598">598</span>
<span id="599">599</span>
<span id="600">600</span>
<span id="601">601</span>
<span id="602">602</span>
<span id="603">603</span>
<span id="604">604</span>
<span id="605">605</span>
<span id="606">606</span>
<span id="607">607</span>
<span id="608">608</span>
<span id="609">609</span>
<span id="610">610</span>
<span id="611">611</span>
<span id="612">612</span>
<span id="613">613</span>
<span id="614">614</span>
<span id="615">615</span>
<span id="616">616</span>
<span id="617">617</span>
<span id="618">618</span>
<span id="619">619</span>
<span id="620">620</span>
<span id="621">621</span>
<span id="622">622</span>
<span id="623">623</span>
<span id="624">624</span>
<span id="625">625</span>
<span id="626">626</span>
<span id="627">627</span>
<span id="628">628</span>
<span id="629">629</span>
<span id="630">630</span>
<span id="631">631</span>
<span id="632">632</span>
<span id="633">633</span>
<span id="634">634</span>
<span id="635">635</span>
<span id="636">636</span>
<span id="637">637</span>
<span id="638">638</span>
<span id="639">639</span>
<span id="640">640</span>
<span id="641">641</span>
<span id="642">642</span>
<span id="643">643</span>
<span id="644">644</span>
<span id="645">645</span>
<span id="646">646</span>
<span id="647">647</span>
<span id="648">648</span>
<span id="649">649</span>
<span id="650">650</span>
<span id="651">651</span>
<span id="652">652</span>
<span id="653">653</span>
<span id="654">654</span>
<span id="655">655</span>
<span id="656">656</span>
<span id="657">657</span>
<span id="658">658</span>
<span id="659">659</span>
<span id="660">660</span>
<span id="661">661</span>
<span id="662">662</span>
<span id="663">663</span>
<span id="664">664</span>
<span id="665">665</span>
<span id="666">666</span>
<span id="667">667</span>
<span id="668">668</span>
<span id="669">669</span>
<span id="670">670</span>
<span id="671">671</span>
<span id="672">672</span>
<span id="673">673</span>
<span id="674">674</span>
<span id="675">675</span>
<span id="676">676</span>
<span id="677">677</span>
<span id="678">678</span>
<span id="679">679</span>
<span id="680">680</span>
<span id="681">681</span>
<span id="682">682</span>
<span id="683">683</span>
<span id="684">684</span>
<span id="685">685</span>
<span id="686">686</span>
<span id="687">687</span>
<span id="688">688</span>
<span id="689">689</span>
<span id="690">690</span>
<span id="691">691</span>
<span id="692">692</span>
<span id="693">693</span>
<span id="694">694</span>
<span id="695">695</span>
<span id="696">696</span>
</pre><pre class="rust"><code><span class="doccomment">//! # Liberland Merit(LLM) Pallet
//!
//! ## Overview
//!
//! Liberland Merit is a Liberland currency that gives political power to citizens.
//!
//! The LLM pallet handles:
//!
//! * creating LLM asset in `pallet-assets` on genesis
//! * LLM inflation to treasury
//! * locking, a.k.a. politipooling the LLM for use in politics
//! * veryfing citizenship status
//!
//! ## LLM lifecycle
//!
//! On Genesis (see `fn create_llm`):
//!
//! * LLM is created in `pallet-assets`
//! * configured `TotalSupply` amount of LLM is created and transferred to **Vault**
//! * configured `PreMintedAmount` is transferred from **Vault** to **Treasury**
//!
//! On yearly basis (see `fn try_mint`):
//!
//! * 90% of **Vault** balance is transferred to **Treasury**
//!
//! Accounts are free to locks in politics, a.k.a. politipool any amount of LLM at any time.
//!
//! Accounts may unlock 10% of locked LLM once every `Withdrawlock` duration (see [Genesis
//! Config](#genesis-config)), but it will suspend their politics rights for `Electionlock`
//! duration.
//!
//! Accounts may freely transfer their not-locked LLM to other accounts.
//!
//! ### Special accounts:
//!
//! * **Treasury**:
//!     * gets preminted and inflation LLM
//!     * derived from PalletID `py/trsry`: `5EYCAe5ijiYfyeZ2JJCGq56LmPyNRAKzpG4QkoQkkQNB5e6Z`
//!
//! * **Vault**:
//!     * gets initial supply of LLM on genesis
//!     * releases 90% of it&#39;s balance to **Trasury** on inflation event (yearly)
//!     * derived from PalletID `llm/safe`: `5EYCAe5hvejUE1BUTDSnxDfCqVkADRicSKqbcJrduV1KCDmk`
//!
//! * **Politipool**,
//!     * gets LLM locked in politics by other accounts (`politics_lock`)
//!     * releases locked LLM back on `politics_unlock`
//!     * derived from PalletID `politilock`: `5EYCAe5ijGqt3WEM9aKUBdth51NEBNz9P84NaUMWZazzWt7c`
//!
//! ## Internal Storage:
//!
//! * `NextMint`: block number for next LLM inflation mint (transfer of 90% from **Vault** to
//!   **Treasury**)
//! * `LLMPolitics`: amount of LLM each account has allocated into politics
//! * `Withdrawlock`: block number until which account can&#39;t do another `politics_unlock`
//! * `Electionlock`: block number until which account can&#39;t participate in politics directly
//!
//! ## Runtime config
//!
//! * `RuntimeEvent`: Event type to use.
//! * `AssetId`: Type of AssetId.
//! * `TotalSupply`: Total amount of LLM to be created on genesis. That&#39;s all LLM that will ever
//!   exit. It will be stored in **Vault**.
//! * `PreMintedAmount`: Amount of LLM that should be minted (a.k.a. transferred from **Vault** to
//!   **Treasury**) on genesis.
//!
//! ## Genesis Config
//!
//! * `unpooling_withdrawlock_duration`: duration, in seconds, for which additional unlocks should
//!   be locked after `politics_unlock`
//! * `unpooling_electionlock_duration`: duration, in seconds, for which politics rights should be
//!   suspended after `politics_unlock`
//!
//! ## Interface
//!
//! ### Dispatchable Functions
//!
//! #### Public
//!
//! These calls can be made from any _Signed_ origin.
//!
//! * `fake_send`: Mint LLM to account. Development only, to be removed/restricted.
//! * `send_llm`: Transfer LLM. Wrapper over `pallet-assets`&#39; `transfer`.
//! * `politics_lock`: Lock LLM into politics pool, a.k.a. politipool.
//! * `politics_unlock`: Unlock 10% of locked LLM. Can&#39;t be called again for a WithdrawalLock
//!   period. Affects political rights for an ElectionLock period.
//! * `createllm`: Creates LLM asset in `pallet-assets`.
//! * `approve_transfer`: As an assembly member you can approve a transfer of LLM. Not implemented.
//!
//! #### Restricted
//!
//! * `treasury_llm_transfer`: Transfer LLM from treasury to specified account. Can only be called
//!   by selected accounts and Senate.
//!
//! ### Public functions
//!
//! * `llm_id`: Asset ID of the LLM asset for `pallet-assets`
//! * `get_llm_vault_account`: AccountId of **Vault** account. **Vault** account stores all LLM
//!   created initially on genesis and releases it to treasury as inflation on regular basis.
//! * `get_llm_treasury_account`: AccountId of **Treasury** account. **Treasury* accounts receives
//!   preminted amount of LLM on genesis and part of LLM from **Vault** as inflation on regular
//!   basis.
//! * `get_llm_politipool_account`: AccountId of **Politipool** account. **Politipool** account
//!   stores LLM locked in politics by all other accounts.
//!
//! ### LLM trait
//!
//! LLM pallet implements LLM trait with following functions available for other pallets:
//!
//! * `check_pooled_llm`: Checks if given account has any LLM locked in politics.
//! * `is_election_unlocked`: Checks if given account has rights to participate in politics
//!   unlocked. They may be locked after `politics_unlock`. This does NOT check if account is a
//!   valid citizen - use `CitizenshipChecker` trait for that.
//! * `get_politi_pooled_amount`: Get total amount of locked LLM across all accounts.
//! * `get_llm_politics`: Get amount of locked LLM for given account.
//!
//! ### CitizenshipChecker trait
//!
//! LLM pallet implements CitizenshipChecker trait with following functions available for other
//! pallets:
//!
//! * `ensure_democracy_allowed`: Checks if given account can participate in democracy actions. It
//!   verifies that it&#39;s a valid citizen, doesn&#39;t have election rights locked and has some LLM
//!   locked in politics.
//! * `ensure_elections_allowed`: Checks if given account can participate in election actions. It
//!   verifies that it&#39;s a valid citizen, doesn&#39;t have election rights locked.
//!
//! License: MIT

</span><span class="attr">#![cfg_attr(not(feature = <span class="string">&quot;std&quot;</span>), no_std)]
</span><span class="kw">pub use </span>pallet::<span class="kw-2">*</span>;
<span class="kw">pub mod </span>traits;

<span class="attr">#[cfg(test)]
</span><span class="kw">mod </span>mock;

<span class="attr">#[cfg(test)]
</span><span class="kw">mod </span>tests;

<span class="doccomment">/// Liberland Merit Pallet
</span><span class="comment">/*
decrease the total supply with 0.9 % per year
mint 0.9% per year to the treasury with pallet assets

Author: &lt;filip@rustsyndi.cat&gt;
Copyright © 2022 Liberland

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/

</span><span class="kw">type </span>Assets&lt;T&gt; = pallet_assets::Pallet&lt;T&gt;;

<span class="attr">#[frame_support::pallet]
</span><span class="kw">pub mod </span>pallet {
	<span class="comment">// Import various types used to declare pallet in scope.
	</span><span class="kw">use super</span>::{traits::LLM, <span class="kw-2">*</span>};
	<span class="kw">use </span>frame_support::{
		pallet_prelude::{DispatchResult, <span class="kw-2">*</span>},
		traits::fungibles::Mutate,
		PalletId,
	};
	<span class="kw">use </span>frame_system::{ensure_signed, pallet_prelude::<span class="kw-2">*</span>};
	<span class="kw">use </span>hex_literal::hex;
	<span class="kw">use </span>scale_info::prelude::vec;
	<span class="kw">use </span>sp_runtime::{
		traits::{AccountIdConversion, StaticLookup},
		AccountId32, SaturatedConversion,
	};
	<span class="kw">use </span>sp_std::vec::Vec;

	<span class="doccomment">/// block number for next LLM inflation mint (transfer of 90% from **Vault** to **Treasury**)
	</span><span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>next_mint)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>NextMint&lt;T: Config&gt; = StorageValue&lt;<span class="kw">_</span>, u64, ValueQuery&gt;; <span class="comment">// ValueQuery ,  OnEmpty = 0

	</span><span class="doccomment">/// amount of LLM each account has allocated into politics
	</span><span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>llm_politics)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>LLMPolitics&lt;T: Config&gt; =
		StorageMap&lt;<span class="kw">_</span>, Blake2_128Concat, T::AccountId, T::Balance, ValueQuery&gt;;

	<span class="doccomment">/// block number until which account can&#39;t do another `politics_unlock`
	</span><span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>withdraw_lock)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>Withdrawlock&lt;T: Config&gt; =
		StorageMap&lt;<span class="kw">_</span>, Blake2_128Concat, T::AccountId, u64, ValueQuery&gt;; <span class="comment">// account and blocknumber

	</span><span class="attr">#[pallet::type_value]
	</span><span class="kw">pub fn </span>WithdrawlockDurationOnEmpty&lt;T: Config&gt;() -&gt; u64 {
		<span class="number">120u64
	</span>}

	<span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>withdraw_lock_duration)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>WithdrawlockDuration&lt;T: Config&gt; =
		StorageValue&lt;<span class="kw">_</span>, u64, ValueQuery, WithdrawlockDurationOnEmpty&lt;T&gt;&gt;; <span class="comment">// seconds

	</span><span class="doccomment">/// block number until which account can&#39;t participate in politics directly
	</span><span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>election_lock)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>Electionlock&lt;T: Config&gt; =
		StorageMap&lt;<span class="kw">_</span>, Blake2_128Concat, T::AccountId, u64, ValueQuery&gt;; <span class="comment">// account and blocknumber

	</span><span class="attr">#[pallet::type_value]
	</span><span class="kw">pub fn </span>ElectionlockDurationOnEmpty&lt;T: Config&gt;() -&gt; u64 {
		<span class="number">120u64
	</span>}
	<span class="attr">#[pallet::storage]
	#[pallet::getter(<span class="kw">fn </span>election_lock_duration)]
	</span><span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">type </span>ElectionlockDuration&lt;T: Config&gt; =
		StorageValue&lt;<span class="kw">_</span>, u64, ValueQuery, ElectionlockDurationOnEmpty&lt;T&gt;&gt;; <span class="comment">// seconds

	</span><span class="attr">#[pallet::genesis_config]
	</span><span class="kw">pub struct </span>GenesisConfig&lt;T: Config&gt; {
		<span class="doccomment">/// duration, in seconds, for which additional unlocks should be locked
		/// after `politics_unlock`
		</span><span class="kw">pub </span>unpooling_withdrawlock_duration: u64,
		<span class="doccomment">/// duration, in seconds, for which politics rights should be suspended
		/// after `politics_unlock`
		</span><span class="kw">pub </span>unpooling_electionlock_duration: u64,
		<span class="kw">pub </span>_phantom: PhantomData&lt;T&gt;,
	}

	<span class="attr">#[cfg(feature = <span class="string">&quot;std&quot;</span>)]
	</span><span class="kw">impl</span>&lt;T: Config&gt; Default <span class="kw">for </span>GenesisConfig&lt;T&gt; {
		<span class="kw">fn </span>default() -&gt; <span class="self">Self </span>{
			<span class="self">Self </span>{
				unpooling_withdrawlock_duration: WithdrawlockDurationOnEmpty::&lt;T&gt;::get(),
				unpooling_electionlock_duration: ElectionlockDurationOnEmpty::&lt;T&gt;::get(),
				_phantom: Default::default(),
			}
		}
	}

	<span class="attr">#[pallet::genesis_build]
	</span><span class="kw">impl</span>&lt;T: Config&gt; GenesisBuild&lt;T&gt; <span class="kw">for </span>GenesisConfig&lt;T&gt; {
		<span class="kw">fn </span>build(<span class="kw-2">&amp;</span><span class="self">self</span>) {
			<span class="kw">let </span>rootorg = frame_system::RawOrigin::Root.into();
			Pallet::&lt;T&gt;::create_llm(rootorg).unwrap();

			WithdrawlockDuration::&lt;T&gt;::put(<span class="kw-2">&amp;</span><span class="self">self</span>.unpooling_withdrawlock_duration);
			ElectionlockDuration::&lt;T&gt;::put(<span class="kw-2">&amp;</span><span class="self">self</span>.unpooling_electionlock_duration);
		}
	}

	<span class="attr">#[pallet::config]
	</span><span class="kw">pub trait </span>Config:
		pallet_assets::Config + frame_system::Config + pallet_identity::Config
	{
		<span class="doccomment">/// The overarching event type.
		</span><span class="kw">type </span>RuntimeEvent: From&lt;Event&lt;<span class="self">Self</span>&gt;&gt; + IsType&lt;&lt;<span class="self">Self </span><span class="kw">as </span>frame_system::Config&gt;::RuntimeEvent&gt;;

		<span class="doccomment">/// Total amount of LLM to be created on genesis. That&#39;s all LLM that
		/// will ever exit. It will be stored in **Vault**.
		</span><span class="kw">type </span>TotalSupply: Get&lt;u64&gt;;

		<span class="doccomment">/// Amount of LLM that should be minted (a.k.a. transferred from
		/// **Vault** to **Treasury**) on genesis.
		</span><span class="kw">type </span>PreMintedAmount: Get&lt;u64&gt;; <span class="comment">// Pre defined the total supply in runtime

		</span><span class="kw">type </span>AssetId: IsType&lt;&lt;<span class="self">Self </span><span class="kw">as </span>pallet_assets::Config&gt;::AssetId&gt;
			+ Parameter
			+ From&lt;u32&gt;
			+ Ord
			+ Copy;
	}

	<span class="kw">pub type </span>AssetId&lt;T&gt; = &lt;T <span class="kw">as </span>Config&gt;::AssetId;

	<span class="attr">#[pallet::error]
	</span><span class="kw">pub enum </span>Error&lt;T&gt; {
		<span class="doccomment">/// Invalid amount
		</span>InvalidAmount,
		<span class="doccomment">/// Balance is less then sending amount
		</span>LowBalance,
		<span class="doccomment">/// Asset already created
		</span>AssetExists,
		<span class="doccomment">/// Account can&#39;t perform this action now
		</span>InvalidAccount,
		<span class="doccomment">/// Not allowed to withdraw more LLM, wait until Withdrawlock
		</span>Gottawait,
		<span class="doccomment">/// No politcal LLM allocated tokens
		</span>NoPolLLM,
		<span class="doccomment">/// Not a Citizen
		</span>NonCitizen,
		<span class="doccomment">/// Temporary locked after unpooling LLM
		</span>Locked,
	}

	<span class="attr">#[pallet::pallet]
	#[pallet::generate_store(<span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">trait </span>Store)]
	</span><span class="kw">pub struct </span>Pallet&lt;T&gt;(<span class="kw">_</span>);

	<span class="attr">#[pallet::hooks]
	</span><span class="kw">impl</span>&lt;T: Config&gt; Hooks&lt;BlockNumberFor&lt;T&gt;&gt; <span class="kw">for </span>Pallet&lt;T&gt; {
		<span class="kw">fn </span>on_initialize(b: T::BlockNumber) -&gt; Weight {
			<span class="kw">let </span>blocknumber = b.saturated_into::&lt;u64&gt;();
			<span class="kw">let </span>_didmint = <span class="self">Self</span>::try_mint(blocknumber);
			Weight::zero()
		}

		<span class="kw">fn </span>on_finalize(_n: T::BlockNumber) {}

		<span class="kw">fn </span>offchain_worker(_n: T::BlockNumber) {}
	}

	<span class="attr">#[pallet::call]
	</span><span class="kw">impl</span>&lt;T: Config&gt; Pallet&lt;T&gt; {
		<span class="doccomment">/// Mint LLM to account by transferring LLM from **Vault**. Development
		/// only, to be removed/restricted.  DO NOT USE IN PROD.
		///
		/// - `to_account`: Account to mint LLM to
		/// - `amount`: Amount of LLM to mint
		///
		/// Emits: `Transferred` from `pallet-assets`
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>fake_send(
			origin: OriginFor&lt;T&gt;,
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			ensure_signed(origin)<span class="question-mark">?</span>;
			<span class="kw">let </span>balance = amount.try_into().map_err(|<span class="kw">_</span>| Error::&lt;T&gt;::InvalidAmount)<span class="question-mark">?</span>;
			<span class="self">Self</span>::transfer_from_vault(to_account, balance)
		}

		<span class="doccomment">/// Wrapper over `pallet-assets` `transfer`. Transfers LLM from sender
		/// to specified account.
		///
		/// - `to_account`: Account to transfer LLM to
		/// - `amount`: Amount of LLM to transfer
		///
		/// Emits: `Transferred` from `pallet-assets`
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>send_llm(
			origin: OriginFor&lt;T&gt;,
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>sender = ensure_signed(origin.clone())<span class="question-mark">?</span>;
			<span class="self">Self</span>::transfer(sender, to_account, amount)
		}

		<span class="doccomment">/// Lock LLM into politics pool, a.k.a. politipool.  Internally it
		/// transfers LLM to **Politipool** account.
		///
		/// * `amount`: Amount of LLM to lock.
		///
		/// Emits:
		/// * `LLMPoliticsLocked`
		/// * `Transferred` from `pallet-assets`
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>politics_lock(origin: OriginFor&lt;T&gt;, amount: T::Balance) -&gt; DispatchResult {
			<span class="kw">let </span>sender = ensure_signed(origin.clone())<span class="question-mark">?</span>;
			<span class="self">Self</span>::transfer_to_politipool(sender.clone(), amount)<span class="question-mark">?</span>;
			LLMPolitics::&lt;T&gt;::mutate(sender.clone(), |b| <span class="kw-2">*</span>b += amount);

			<span class="kw">let </span>amount_u64 = amount.try_into().map_err(|<span class="kw">_</span>| Error::&lt;T&gt;::InvalidAmount)<span class="question-mark">?</span>;
			<span class="self">Self</span>::deposit_event(Event::&lt;T&gt;::LLMPoliticsLocked(sender, amount_u64));
			<span class="prelude-val">Ok</span>(())
		}

		<span class="doccomment">/// Unlock 10% of account&#39;s LLM from politics pool, a.k.a. politipool.
		/// Internally it transfers LLM from **Politipool** account.
		///
		/// Can only be called once per `Withdrawlock` duration, will fail with
		/// `Gottawait` otherwise.
		///
		/// Emits:
		/// * `LLMPoliticsLocked`
		/// * `Transferred` from `pallet-assets`
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>politics_unlock(origin: OriginFor&lt;T&gt;) -&gt; DispatchResult {
			<span class="kw">let </span>sender: T::AccountId = ensure_signed(origin.clone())<span class="question-mark">?</span>;
			<span class="comment">// check if we have political locked LLM
			</span><span class="macro">log::info!</span>(<span class="string">&quot;unlock called&quot;</span>);

			<span class="kw">let </span>politics_balance = LLMPolitics::&lt;T&gt;::get(sender.clone());
			<span class="macro">ensure!</span>(politics_balance &gt; <span class="number">0u8</span>.into(), Error::&lt;T&gt;::InvalidAccount);

			<span class="kw">let </span>current_block_number: u64 =
				&lt;frame_system::Pallet&lt;T&gt;&gt;::block_number().try_into().unwrap_or(<span class="number">0u64</span>);
			<span class="macro">ensure!</span>(current_block_number &gt; Withdrawlock::&lt;T&gt;::get(<span class="kw-2">&amp;</span>sender), Error::&lt;T&gt;::Gottawait);

			<span class="kw">let </span>ten_percent: T::Balance = <span class="self">Self</span>::get_10_percent(politics_balance);
			<span class="macro">log::info!</span>(<span class="string">&quot;releasing 10% {:?}&quot;</span>, ten_percent.clone());

			<span class="self">Self</span>::transfer_from_politipool(sender.clone(), ten_percent)<span class="question-mark">?</span>;
			LLMPolitics::&lt;T&gt;::mutate(<span class="kw-2">&amp;</span>sender, |b| <span class="kw-2">*</span>b -= ten_percent);

			<span class="kw">let </span>withdraw_lock_end =
				<span class="self">Self</span>::get_future_block_with_seconds(<span class="self">Self</span>::withdraw_lock_duration());
			<span class="kw">let </span>election_lock_end =
				<span class="self">Self</span>::get_future_block_with_seconds(<span class="self">Self</span>::election_lock_duration());
			Withdrawlock::&lt;T&gt;::insert(<span class="kw-2">&amp;</span>sender, withdraw_lock_end);
			Electionlock::&lt;T&gt;::insert(<span class="kw-2">&amp;</span>sender, election_lock_end);

			<span class="kw">let </span>amount = ten_percent.try_into().map_err(|<span class="kw">_</span>| Error::&lt;T&gt;::InvalidAmount)<span class="question-mark">?</span>;
			<span class="self">Self</span>::deposit_event(Event::&lt;T&gt;::LLMPoliticsUnlocked(sender, amount));
			<span class="prelude-val">Ok</span>(())
		}

		<span class="doccomment">/// Transfer LLM from treasury to specified account. Can only be called
		/// by selected accounts and Senate.
		///
		/// - `to_account`: Account to transfer to.
		/// - `amount`: Amount to transfer.
		///
		/// Emits: `Transferred` from `pallet-assets`
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>treasury_llm_transfer(
			origin: OriginFor&lt;T&gt;,
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>account_map: Vec&lt;T::AccountId&gt; = <span class="macro">vec!</span>[
				<span class="self">Self</span>::account_id32_to_accountid(
					<span class="macro">hex!</span>[<span class="string">&quot;91c7c2ea588cc63a45a540d4f2dbbae7967d415d0daec3d6a5a0641e969c635c&quot;</span>].into(), <span class="comment">/* test senate */
				</span>),
				<span class="self">Self</span>::account_id32_to_accountid(
					<span class="macro">hex!</span>[<span class="string">&quot;9b1e9c82659816b21042772690aafdc58e784aa69eeefdb68fa1e86a036ff634&quot;</span>].into(),
				), <span class="comment">// V + DEVKEY + N + M
			</span>];
			<span class="kw">let </span>sender: T::AccountId = ensure_signed(origin)<span class="question-mark">?</span>;

			<span class="macro">ensure!</span>(account_map.contains(<span class="kw-2">&amp;</span>sender), Error::&lt;T&gt;::InvalidAccount);

			<span class="self">Self</span>::transfer_from_treasury(to_account, amount)
		}

		<span class="doccomment">/// Create LLM manually plus mint it to the treasury
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)] </span><span class="comment">// change me
		</span><span class="kw">pub fn </span>createllm(origin: OriginFor&lt;T&gt;) -&gt; DispatchResult {
			ensure_signed(origin.clone())<span class="question-mark">?</span>;
			<span class="self">Self</span>::create_llm(origin)<span class="question-mark">?</span>;

			<span class="prelude-val">Ok</span>(())
		}

		<span class="doccomment">/// Allow the senate to approve transfers
		</span><span class="attr">#[pallet::weight(<span class="number">10_000</span>)]
		</span><span class="kw">pub fn </span>approve_transfer(
			_origin: OriginFor&lt;T&gt;,
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>_x = amount;
			<span class="kw">let </span>_y = to_account;
			<span class="macro">todo!</span>(<span class="string">&quot;approve_transfer&quot;</span>);
		}
	}

	<span class="attr">#[pallet::event]
	#[pallet::generate_deposit(<span class="kw">pub</span>(<span class="kw">super</span>) <span class="kw">fn </span>deposit_event)]
	</span><span class="kw">pub enum </span>Event&lt;T: Config&gt; {
		<span class="doccomment">/// New llm has been minted
		</span>MintedLLM(T::AccountId, T::Balance),
		<span class="doccomment">/// New LLM has been created
		</span>LLMCreated(T::AccountId, T::Balance), <span class="comment">// acountid, amount
		</span><span class="doccomment">/// X amount of LLM has been unlocked
		</span>LLMPoliticsLocked(T::AccountId, T::Balance),
		<span class="doccomment">/// sent to user account, amount
		</span>LLMPoliticsUnlocked(T::AccountId, T::Balance),
	}

	<span class="kw">impl</span>&lt;T: Config&gt; Pallet&lt;T&gt; {
		<span class="kw">pub fn </span>account_id32_to_accountid(accountid32: AccountId32) -&gt; T::AccountId {
			<span class="kw">let </span><span class="kw-2">mut </span>init_account32 = AccountId32::as_ref(<span class="kw-2">&amp;</span>accountid32);
			<span class="kw">let </span>init_account: T::AccountId = T::AccountId::decode(<span class="kw-2">&amp;mut </span>init_account32).unwrap();
			init_account
		}

		<span class="kw">fn </span>balance(account: T::AccountId) -&gt; T::Balance {
			Assets::&lt;T&gt;::balance(<span class="self">Self</span>::llm_id().into(), account)
		}

		<span class="comment">// get 10% of the users balance
		</span><span class="kw">fn </span>get_10_percent(balance: T::Balance) -&gt; T::Balance {
			balance / <span class="number">10u8</span>.into()
		}

		<span class="kw">fn </span>transfer(
			from_account: T::AccountId,
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>origin = frame_system::RawOrigin::Signed(from_account.clone()).into();
			Assets::&lt;T&gt;::transfer(
				origin,
				<span class="self">Self</span>::llm_id().into(),
				T::Lookup::unlookup(to_account.clone()),
				amount.clone(),
			)
		}

		<span class="kw">fn </span>transfer_to_politipool(
			from_account: T::AccountId,
			amount_balance: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>politipool_account = <span class="self">Self</span>::get_llm_politipool_account();
			<span class="self">Self</span>::transfer(from_account, politipool_account, amount_balance)
		}

		<span class="kw">fn </span>transfer_from_politipool(
			to_account: T::AccountId,
			amount: T::Balance,
		) -&gt; DispatchResult {
			<span class="kw">let </span>politipool_account = <span class="self">Self</span>::get_llm_politipool_account();
			<span class="self">Self</span>::transfer(politipool_account, to_account, amount)
		}

		<span class="kw">fn </span>transfer_from_vault(to_account: T::AccountId, amount: T::Balance) -&gt; DispatchResult {
			<span class="kw">let </span>vault = <span class="self">Self</span>::get_llm_vault_account();
			<span class="self">Self</span>::transfer(vault, to_account, amount)
		}

		<span class="kw">fn </span>transfer_from_treasury(to_account: T::AccountId, amount: T::Balance) -&gt; DispatchResult {
			<span class="kw">let </span>treasury = <span class="self">Self</span>::get_llm_treasury_account();
			<span class="self">Self</span>::transfer(treasury, to_account, amount)
		}

		<span class="comment">// could do like a OriginFor&lt;SenateGroup&gt; or X(Tech) committee
		</span><span class="kw">fn </span>create_llm(origin: OriginFor&lt;T&gt;) -&gt; DispatchResult {
			<span class="kw">let </span>assetid = <span class="self">Self</span>::llm_id().into();
			<span class="kw">let </span>treasury = <span class="self">Self</span>::get_llm_treasury_account();
			<span class="kw">let </span>challenger_lookup: &lt;T::Lookup <span class="kw">as </span>StaticLookup&gt;::Source =
				T::Lookup::unlookup(treasury.clone());
			<span class="kw">let </span>asset_supply = Assets::&lt;T&gt;::total_supply(assetid.into());
			<span class="macro">ensure!</span>(asset_supply == <span class="number">0u8</span>.into(), Error::&lt;T&gt;::AssetExists); <span class="comment">// if the asset supply is zero == that means it is not been created and we can create

			</span><span class="kw">let </span>min_balance: T::Balance = <span class="number">1u8</span>.into();
			<span class="kw">let </span>name: Vec&lt;u8&gt; = <span class="string">&quot;Liberland Merit&quot;</span>.into();
			<span class="kw">let </span>symbol: Vec&lt;u8&gt; = <span class="string">&quot;LLM&quot;</span>.into();
			<span class="kw">let </span>decimals: u8 = <span class="number">0u8</span>;
			Assets::&lt;T&gt;::force_create(
				origin.clone(),
				assetid.into(),
				challenger_lookup,
				<span class="bool-val">true</span>,
				min_balance,
			)<span class="question-mark">?</span>;
			Assets::&lt;T&gt;::force_set_metadata(
				origin.clone(),
				assetid.into(),
				name,
				symbol,
				decimals,
				<span class="bool-val">false</span>,
			)<span class="question-mark">?</span>;
			<span class="self">Self</span>::deposit_event(Event::&lt;T&gt;::LLMCreated(treasury.clone(), <span class="number">0u8</span>.into()));

			<span class="comment">// Mint tokens into the llm/vault
			</span><span class="kw">let </span>vaultac: T::AccountId = <span class="self">Self</span>::get_llm_vault_account();
			<span class="kw">let </span>supply = T::TotalSupply::get().try_into().map_err(|<span class="kw">_</span>| Error::&lt;T&gt;::InvalidAmount)<span class="question-mark">?</span>;
			Assets::&lt;T&gt;::mint_into(assetid, <span class="kw-2">&amp;</span>vaultac, supply)<span class="question-mark">?</span>;

			<span class="kw">let </span>nextblock = <span class="self">Self</span>::get_future_block();
			NextMint::&lt;T&gt;::put(nextblock);

			<span class="comment">// Mint a.k.a. transfer to treasury
			</span><span class="kw">let </span>preminted =
				T::PreMintedAmount::get().try_into().map_err(|<span class="kw">_</span>| Error::&lt;T&gt;::InvalidAmount)<span class="question-mark">?</span>;
			<span class="self">Self</span>::mint_tokens(assetid.into(), preminted)
		}

		<span class="doccomment">/// Asset ID of the LLM asset for `pallet-assets`
		</span><span class="kw">pub fn </span>llm_id() -&gt; AssetId&lt;T&gt; {
			<span class="number">1u32</span>.into()
		}

		<span class="doccomment">/// AccountId of **Vault** account. **Vault** account stores all LLM
		/// created initially on genesis and releases it to treasury as
		/// inflation on regular basis.
		</span><span class="kw">pub fn </span>get_llm_vault_account() -&gt; T::AccountId {
			PalletId(<span class="kw-2">*</span><span class="string">b&quot;llm/safe&quot;</span>).into_account_truncating()
		}

		<span class="doccomment">/// AccountId of **Treasury** account. **Treasury* accounts receives
		/// preminted amount of LLM on genesis and part of LLM from **Vault** as
		/// inflation on regular basis.
		</span><span class="kw">pub fn </span>get_llm_treasury_account() -&gt; T::AccountId {
			PalletId(<span class="kw-2">*</span><span class="string">b&quot;py/trsry&quot;</span>).into_account_truncating()
		}

		<span class="doccomment">/// AccountId of **Politipool** account. **Politipool** account stores LLM
		/// locked in politics by all other accounts.
		</span><span class="kw">pub fn </span>get_llm_politipool_account() -&gt; T::AccountId {
			PalletId(<span class="kw-2">*</span><span class="string">b&quot;polilock&quot;</span>).into_account_truncating()
		}

		<span class="kw">fn </span>get_future_block_with_seconds(seconds: u64) -&gt; u64 {
			<span class="kw">let </span>current_block_number: u64 =
				&lt;frame_system::Pallet&lt;T&gt;&gt;::block_number().try_into().unwrap_or(<span class="number">0u64</span>);
			<span class="kw">let </span>seconds_per_block: u64 = <span class="number">6u64</span>; <span class="comment">// 6 seconds per block
			</span><span class="kw">let </span>block = current_block_number + seconds / seconds_per_block;
			block
		}

		<span class="kw">fn </span>get_future_block() -&gt; u64 {
			<span class="kw">let </span>current_block_number: u64 =
				&lt;frame_system::Pallet&lt;T&gt;&gt;::block_number().try_into().unwrap_or(<span class="number">0u64</span>);
			<span class="kw">let </span>blocks_per_second: u64 = <span class="number">6u64</span>; <span class="comment">// 6 seconds per block
			</span><span class="kw">let </span>one_minute: u64 = <span class="number">60u64 </span>/ blocks_per_second;
			<span class="kw">let </span>one_day: u64 = one_minute * <span class="number">60u64 </span>* <span class="number">24u64</span>;
			<span class="kw">let </span>_one_year: u64 = one_day * <span class="number">365u64</span>; <span class="comment">//365.24
			</span><span class="kw">let </span>block = current_block_number + <span class="number">2u64 </span>* one_minute; <span class="comment">// 2 minutes
			</span>block
		}

		<span class="comment">// each time we mint (should be each year), release 10% from vault
		</span><span class="kw">fn </span>get_allowed_spending() -&gt; T::Balance {
			<span class="kw">let </span>asset_id = <span class="self">Self</span>::llm_id().into();
			<span class="kw">let </span>vault_account = <span class="self">Self</span>::get_llm_vault_account();
			<span class="kw">let </span>unminted_amount = Assets::&lt;T&gt;::balance(asset_id, vault_account);
			<span class="kw">let </span>release_amount = unminted_amount / <span class="number">10u8</span>.into();
			release_amount
		}

		<span class="kw">fn </span>try_mint(block: u64) -&gt; bool {
			<span class="kw">if </span>block &lt; NextMint::&lt;T&gt;::get() {
				<span class="kw">return </span><span class="bool-val">false
			</span>}
			NextMint::&lt;T&gt;::put(<span class="self">Self</span>::get_future_block());

			<span class="kw">let </span>mint_amount = <span class="self">Self</span>::get_allowed_spending();
			<span class="self">Self</span>::mint_tokens(<span class="number">0</span>.into(), mint_amount).unwrap();

			<span class="macro">log::info!</span>(<span class="string">&quot;try_mint ran all the way&quot;</span>);
			<span class="bool-val">true
		</span>}

		<span class="doccomment">/// Mint tokens to the treasury account. Sends tokens from the llm/vault to the treasury
		</span><span class="kw">fn </span>mint_tokens(_assetid: AssetId&lt;T&gt;, amount: T::Balance) -&gt; DispatchResult {
			<span class="kw">let </span>treasury = <span class="self">Self</span>::get_llm_treasury_account();

			<span class="self">Self</span>::transfer_from_vault(treasury.clone(), amount)<span class="question-mark">?</span>;
			<span class="self">Self</span>::deposit_event(Event::&lt;T&gt;::MintedLLM(treasury, amount));

			<span class="prelude-val">Ok</span>(())
		}
	}

	<span class="kw">impl</span>&lt;T: Config&gt; traits::LLM&lt;T::AccountId, T::Balance&gt; <span class="kw">for </span>Pallet&lt;T&gt; {
		<span class="kw">fn </span>check_pooled_llm(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; bool {
			LLMPolitics::&lt;T&gt;::get(account) &gt; <span class="number">0u8</span>.into()
		}

		<span class="kw">fn </span>is_election_unlocked(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; bool {
			<span class="kw">if </span>Electionlock::&lt;T&gt;::contains_key(account) {
				<span class="kw">let </span>current_block_number: u64 =
					&lt;frame_system::Pallet&lt;T&gt;&gt;::block_number().try_into().unwrap_or(<span class="number">0u64</span>);
				<span class="kw">let </span>unlocked_on_block = Electionlock::&lt;T&gt;::get(account);
				<span class="kw">return </span>current_block_number &gt; unlocked_on_block
			}
			<span class="bool-val">true
		</span>}

		<span class="kw">fn </span>get_politi_pooled_amount() -&gt; T::Balance {
			<span class="kw">let </span>politipool_account = <span class="self">Self</span>::get_llm_politipool_account();
			<span class="self">Self</span>::balance(politipool_account)
		}

		<span class="kw">fn </span>get_llm_politics(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; T::Balance {
			LLMPolitics::&lt;T&gt;::get(account)
		}
	}

	<span class="kw">impl</span>&lt;T: Config&gt; Pallet&lt;T&gt; {
		<span class="kw">fn </span>is_known_good(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; bool {
			<span class="kw">match </span>pallet_identity::Pallet::&lt;T&gt;::identity(account) {
				<span class="prelude-val">Some</span>(reg) =&gt;
					reg.info.citizen != pallet_identity::Data::None &amp;&amp;
						reg.judgements.contains(<span class="kw-2">&amp;</span>(<span class="number">0u32</span>, pallet_identity::Judgement::KnownGood)),
				<span class="prelude-val">None </span>=&gt; <span class="bool-val">false</span>,
			}
		}
	}

	<span class="kw">impl</span>&lt;T: Config&gt; traits::CitizenshipChecker&lt;T::AccountId&gt; <span class="kw">for </span>Pallet&lt;T&gt; {
		<span class="kw">fn </span>ensure_democracy_allowed(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; <span class="prelude-ty">Result</span>&lt;(), DispatchError&gt; {
			<span class="macro">ensure!</span>(<span class="self">Self</span>::is_known_good(account), Error::&lt;T&gt;::NonCitizen);
			<span class="macro">ensure!</span>(<span class="self">Self</span>::is_election_unlocked(account), Error::&lt;T&gt;::Locked);
			<span class="macro">ensure!</span>(<span class="self">Self</span>::check_pooled_llm(account), Error::&lt;T&gt;::NoPolLLM);
			<span class="prelude-val">Ok</span>(())
		}

		<span class="kw">fn </span>ensure_elections_allowed(account: <span class="kw-2">&amp;</span>T::AccountId) -&gt; <span class="prelude-ty">Result</span>&lt;(), DispatchError&gt; {
			<span class="macro">ensure!</span>(<span class="self">Self</span>::is_known_good(account), Error::&lt;T&gt;::NonCitizen);
			<span class="macro">ensure!</span>(<span class="self">Self</span>::is_election_unlocked(account), Error::&lt;T&gt;::Locked);
			<span class="prelude-val">Ok</span>(())
		}
	}
}
</code></pre></div>
</section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="pallet_llm" data-themes="" data-resource-suffix="" data-rustdoc-version="1.67.0-nightly (e75aab045 2022-11-09)" data-search-js="search-39ee4160c7dc16c9.js" data-settings-js="settings-3a0b9947ba1bd99a.js" data-settings-css="settings-a66f7524084a489a.css" ></div></body></html>